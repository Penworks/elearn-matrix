//	psuedo copy of codeigniter's security lib
//	borrowed heavily on the work of
//  https://github.com/chriso/node-validator/
//	This is derived from the Codeigniter Security library.
//	Codeigniter is Copyright (c) 2008 - 2011, EllisLab, Inc.
//	and the license for the version derived from can be found
//	here: https://github.com/EllisLab/CodeIgniter/blob/v2.1.0/license.txt
(function(){"use strict";function c(e,t){var n=["on\\w*","style","xmlns","formaction"];t||n.push("xmlns");var r,i,s,o=new RegExp("("+n.join("|")+")\\s*=\\s*([^\\s>]*)","gi"),u=new RegExp("("+n.join("|")+")\\s*=\\s*(\\042|\\047)([^\\2]*?)(\\2)","gi");do{r=0;i=[];s=null;do{s&&i.push(p(s[0],"/"));s=o.exec(e)}while(s);do{s&&i.push(p(s[0],"/"));s=u.exec(e)}while(s);i.length>0&&(e=e.replace(new RegExp("<(\\/?[^><]+?)([^A-Za-z<>\\-])(.*?)("+i.join("|")+")(.*?)([\\s><])([><]*)","i"),function(e,t,n,i,s,o,u,a){r++;return"<"+t+" "+i+o+u+a}))}while(r);return e}function h(e){for(var t in u)u.hasOwnProperty(t)&&(e=e.replace(u[t],""));return e}function p(e,t){return(e+"").replace(new RegExp("[.\\\\+*?\\[\\^\\]$(){}=!<>|:\\"+(t||"")+"-]","g"),"\\$&")}function d(){return"beaf6cec1bee7eb442629516b41d5453"}function v(e){return e.replace(">","&gt;").replace("<","&lt;").replace("\\","\\\\")}function m(e){var t="";e.replace(/\\s*[a-z\-]+\\s*=\\s*(?:\042|\047)(?:[^\\1]*?)\\1/gi,function(e){t+=e.replace(/\/\*.*?\*\//g,"")});return t}var e=typeof exports!="undefined"?exports:typeof window!="undefined"?window:this,t=e.Security=e.Security||{},n={"&nbsp;":" ","&iexcl;":"¡","&cent;":"¢","&pound;":"£","&curren;":"€","&yen;":"¥","&brvbar;":"Š","&sect;":"§","&uml;":"š","&copy;":"©","&ordf;":"ª","&laquo;":"«","&not;":"¬","&shy;":"­","&reg;":"®","&macr;":"¯","&deg;":"°","&plusmn;":"±","&sup2;":"²","&sup3;":"³","&acute;":"Ž","&micro;":"µ","&para;":"¶","&middot;":"·","&cedil;":"ž","&sup1;":"¹","&ordm;":"º","&raquo;":"»","&frac14;":"Œ","&frac12;":"œ","&frac34;":"Ÿ","&iquest;":"¿","&Agrave;":"À","&Aacute;":"Á","&Acirc;":"Â","&Atilde;":"Ã","&Auml;":"Ä","&Aring;":"Å","&AElig;":"Æ","&Ccedil;":"Ç","&Egrave;":"È","&Eacute;":"É","&Ecirc;":"Ê","&Euml;":"Ë","&Igrave;":"Ì","&Iacute;":"Í","&Icirc;":"Î","&Iuml;":"Ï","&ETH;":"Ð","&Ntilde;":"Ñ","&Ograve;":"Ò","&Oacute;":"Ó","&Ocirc;":"Ô","&Otilde;":"Õ","&Ouml;":"Ö","&times;":"×","&Oslash;":"Ø","&Ugrave;":"Ù","&Uacute;":"Ú","&Ucirc;":"Û","&Uuml;":"Ü","&Yacute;":"Ý","&THORN;":"Þ","&szlig;":"ß","&agrave;":"à","&aacute;":"á","&acirc;":"â","&atilde;":"ã","&auml;":"ä","&aring;":"å","&aelig;":"æ","&ccedil;":"ç","&egrave;":"è","&eacute;":"é","&ecirc;":"ê","&euml;":"ë","&igrave;":"ì","&iacute;":"í","&icirc;":"î","&iuml;":"ï","&eth;":"ð","&ntilde;":"ñ","&ograve;":"ò","&oacute;":"ó","&ocirc;":"ô","&otilde;":"õ","&ouml;":"ö","&divide;":"÷","&oslash;":"ø","&ugrave;":"ù","&uacute;":"ú","&ucirc;":"û","&uuml;":"ü","&yacute;":"ý","&thorn;":"þ","&yuml;":"ÿ","&quot;":'"',"&lt;":"<","&gt;":">","&apos;":"'","&minus;":"−","&circ;":"ˆ","&tilde;":"˜","&Scaron;":"Š","&lsaquo;":"‹","&OElig;":"Œ","&lsquo;":"‘","&rsquo;":"’","&ldquo;":"“","&rdquo;":"”","&bull;":"•","&ndash;":"–","&mdash;":"—","&trade;":"™","&scaron;":"š","&rsaquo;":"›","&oelig;":"œ","&Yuml;":"Ÿ","&fnof;":"ƒ","&Alpha;":"Α","&Beta;":"Β","&Gamma;":"Γ","&Delta;":"Δ","&Epsilon;":"Ε","&Zeta;":"Ζ","&Eta;":"Η","&Theta;":"Θ","&Iota;":"Ι","&Kappa;":"Κ","&Lambda;":"Λ","&Mu;":"Μ","&Nu;":"Ν","&Xi;":"Ξ","&Omicron;":"Ο","&Pi;":"Π","&Rho;":"Ρ","&Sigma;":"Σ","&Tau;":"Τ","&Upsilon;":"Υ","&Phi;":"Φ","&Chi;":"Χ","&Psi;":"Ψ","&Omega;":"Ω","&alpha;":"α","&beta;":"β","&gamma;":"γ","&delta;":"δ","&epsilon;":"ε","&zeta;":"ζ","&eta;":"η","&theta;":"θ","&iota;":"ι","&kappa;":"κ","&lambda;":"λ","&mu;":"μ","&nu;":"ν","&xi;":"ξ","&omicron;":"ο","&pi;":"π","&rho;":"ρ","&sigmaf;":"ς","&sigma;":"σ","&tau;":"τ","&upsilon;":"υ","&phi;":"φ","&chi;":"χ","&psi;":"ψ","&omega;":"ω","&thetasym;":"ϑ","&upsih;":"ϒ","&piv;":"ϖ","&ensp;":" ","&emsp;":" ","&thinsp;":" ","&zwnj;":"‌","&zwj;":"‍","&lrm;":"‎","&rlm;":"‏","&sbquo;":"‚","&bdquo;":"„","&dagger;":"†","&Dagger;":"‡","&hellip;":"…","&permil;":"‰","&prime;":"′","&Prime;":"″","&oline;":"‾","&frasl;":"⁄","&euro;":"€","&image;":"ℑ","&weierp;":"℘","&real;":"ℜ","&alefsym;":"ℵ","&larr;":"←","&uarr;":"↑","&rarr;":"→","&darr;":"↓","&harr;":"↔","&crarr;":"↵","&lArr;":"⇐","&uArr;":"⇑","&rArr;":"⇒","&dArr;":"⇓","&hArr;":"⇔","&forall;":"∀","&part;":"∂","&exist;":"∃","&empty;":"∅","&nabla;":"∇","&isin;":"∈","&notin;":"∉","&ni;":"∋","&prod;":"∏","&sum;":"∑","&lowast;":"∗","&radic;":"√","&prop;":"∝","&infin;":"∞","&ang;":"∠","&and;":"∧","&or;":"∨","&cap;":"∩","&cup;":"∪","&int;":"∫","&there4;":"∴","&sim;":"∼","&cong;":"≅","&asymp;":"≈","&ne;":"≠","&equiv;":"≡","&le;":"≤","&ge;":"≥","&sub;":"⊂","&sup;":"⊃","&nsub;":"⊄","&sube;":"⊆","&supe;":"⊇","&oplus;":"⊕","&otimes;":"⊗","&perp;":"⊥","&sdot;":"⋅","&lceil;":"⌈","&rceil;":"⌉","&lfloor;":"⌊","&rfloor;":"⌋","&lang;":"〈","&rang;":"〉","&loz;":"◊","&spades;":"♠","&clubs;":"♣","&hearts;":"♥","&diams;":"♦"},r=function(e){if(e.indexOf("&")==-1)return e;for(var t in n)n.hasOwnProperty(t)&&(e=e.replace(new RegExp(t,"g"),n[t]));e=e.replace(/&#x(0*[0-9a-f]{2,5});?/gi,function(e,t){return String.fromCharCode(parseInt(+t,16))});e=e.replace(/&#([0-9]{2,4});?/gi,function(e,t){return String.fromCharCode(+t)});e=e.replace(/&amp;/g,"&");return e},i=function(e){e=e.replace(/&/g,"&amp;");e=e.replace(/'/g,"&#39;");for(var t in n)n.hasOwnProperty(t)&&(e=e.replace(new RegExp(n[t],"g"),t));return e};t.entities={encode:i,decode:r};var s={"document.cookie":"[removed]","document.write":"[removed]",".parentNode":"[removed]",".innerHTML":"[removed]","window.location":"[removed]","-moz-binding":"[removed]","<!--":"&lt;!--","-->":"--&gt;","<![CDATA[":"&lt;![CDATA["},o={"javascript\\s*:":"[removed]","expression\\s*(\\(|&\\#40;)":"[removed]","vbscript\\s*:":"[removed]","Redirect\\s+302":"[removed]","([\"'])?data\\s*:[^\\1]*?base64[^\\1]*?,[^\\1]*?\\1?":"[removed]"},u=[/%0[0-8bcef]/g,/%1[0-9a-f]/g,/[\x00-\x08]/g,/\x0b/g,/\x0c/g,/[\x0e-\x1f]/g],a=["javascript","expression","vbscript","script","applet","alert","document","write","cookie","window","base64"],f=function(e){return typeof Array.isArray!="undefined"?Array.isArray(e):Object.prototype.toString.apply(e)==="[object Array]"},l=t.xssClean=function(e,n){var i;if(f(e)){i=e.length;while(i--)e[i]=t.xssClean(e[i]);return e}if(typeof e=="object"){for(i in e)e.hasOwnProperty(i)&&(e[i]=t.xssClean(e[i]));return e}e=h(e);e=e.replace(/\&([a-z\_0-9]+)\=([a-z\_0-9]+)/i,d()+"$1=$2");e=e.replace(/(&\#?[0-9a-z]{2,})([\x00-\x20])*;?/i,"$1;$2");e=e.replace(/(&\#x?)([0-9A-F]+);?/i,"$1;$2");e=e.replace(d(),"&");e=decodeURIComponent(e);e=e.replace(/[a-z]+=([\'\"]).*?\\1/gi,function(e,t){return e.replace(t,v(t))});e=e.replace(/<\w+.*?(?=>|<|$)/gi,function(e){return e.replace(e,r(e))});e=h(e);e=e.replace("	"," ");var u=e;for(i in s)s.hasOwnProperty(i)&&(e=e.replace(i,s[i]));for(i in o)o.hasOwnProperty(i)&&(e=e.replace(new RegExp(i,"i"),o[i]));for(i in a)if(a.hasOwnProperty(i)){var l=a[i].split("").join("\\s*")+"\\s*";e=e.replace(new RegExp("("+l+")(\\W)","ig"),function(e,t,n){return t.replace(/\s+/g,"")+n})}var p;do{p=e;e.match(/<a/i)&&(e=e.replace(/<a\\s+([^>]*?)(>|$)/gi,function(e,t,n){t=m(t.replace("<","").replace(">",""));return e.replace(t,t.replace(/href=.*?(alert\(|alert&\#40;|javascript\:|livescript\:|mocha\:|charset\=|window\.|document\.|\.cookie|<script|<xss|base64\\s*,)/gi,""))}));e.match(/<img/i)&&(e=e.replace(/<img\\s+([^>]*?)(\\s?\/?>|$)/gi,function(e,t,n){t=m(t.replace("<","").replace(">",""));return e.replace(t,t.replace(/src=.*?(alert\(|alert&\#40;|javascript\:|livescript\:|mocha\:|charset\=|window\.|document\.|\.cookie|<script|<xss|base64\\s*,)/gi,""))}));if(e.match(/script/i)||e.match(/xss/i))e=e.replace(/<(\/*)(script|xss)(.*?)\>/gi,"[removed]")}while(p!=e);e=c(e,n);var g="alert|applet|audio|basefont|base|behavior|bgsound|blink|body|embed|expression|form|frameset|frame|head|html|ilayer|iframe|input|isindex|layer|link|meta|object|plaintext|style|script|textarea|title|video|xml|xss";e=e.replace(new RegExp("<(/*\\s*)("+g+")([^><]*)([><]*)","gi"),function(e,t,n,r,i){return"&lt;"+t+n+r+i.replace(">","&gt;").replace("<","&lt;")});e=e.replace(/(alert|cmd|passthru|eval|exec|expression|system|fopen|fsockopen|file|file_get_contents|readfile|unlink)(\\s*)\((.*?)\)/gi,"$1$2&#40;$3&#41;");for(i in s)s.hasOwnProperty(i)&&(e=e.replace(i,s[i]));for(i in o)o.hasOwnProperty(i)&&(e=e.replace(new RegExp(i,"i"),o[i]));return n?e!==u:e}})();